<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>â– åä¸€ï½œåœ£è¯å¿«ä¹ï¼</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: #0f0505;
            color: white;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            min-height: 100vh;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        #scene3d {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            outline: none;
            z-index: 1;
        }
        
        /* æ ‡é¢˜å‘ä¸‹ç§»åŠ¨ - å…³é”®ä¿®æ”¹ï¼štopä»20pxæ”¹ä¸º60px */
        .title-overlay {
            position: fixed;
            top: 60px;          /* æ ‡é¢˜å‘ä¸‹ç§»åŠ¨ï¼Œé¿å…é®æŒ¡å†…å®¹ */
            left: 0;
            width: 100%;
            text-align: center;
            z-index: 100;
            pointer-events: none;
            padding: 0 20px;
        }
        
        .main-title {
            font-size: 3.2rem;
            font-family: 'Mountains of Christmas', 'Ma Shan Zheng', cursive;
            letter-spacing: 2px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            text-align: center;
            font-weight: 700;
        }
        
        .square-char {
            display: inline-block;
            font-size: 3.6rem;
            vertical-align: middle;
            margin-right: 8px;
            line-height: 1;
            font-family: 'Mountains of Christmas', 'Ma Shan Zheng', cursive;
        }
        
        /* å·¦å³æ§ä»¶é¢æ¿å®¹å™¨ */
        .controls-container {
            position: fixed;
            bottom: 20px;
            left: 0;
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            padding: 0 20px;
            z-index: 100;
            pointer-events: none;
        }
        
        /* å·¦ä¾§é£æ ¼é€‰æ‹©é¢æ¿ */
        .style-panel {
            background: rgba(0, 0, 0, 0.6);
            border-radius: 12px;
            padding: 20px;
            width: 280px;
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.15);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.4);
            pointer-events: auto;
        }
        
        .style-panel h3 {
            color: #FFD700;
            margin-bottom: 15px;
            font-size: 1.2rem;
            text-align: center;
        }
        
        .style-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }
        
        /* å³ä¾§é€Ÿåº¦æ§åˆ¶é¢æ¿ */
        .speed-panel {
            background: rgba(0, 0, 0, 0.6);
            border-radius: 12px;
            padding: 20px;
            width: 320px;
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.15);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.4);
            pointer-events: auto;
        }
        
        .speed-panel h3 {
            color: #FFD700;
            margin-bottom: 15px;
            font-size: 1.2rem;
            text-align: center;
        }
        
        .style-btn {
            padding: 10px 8px;
            border: none;
            border-radius: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.12);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.2);
            pointer-events: auto;
            font-size: 0.9rem;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .style-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        .style-btn.active {
            transform: translateY(-2px);
            box-shadow: 0 0 12px currentColor;
        }
        
        .speed-controls {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .slider-container {
            display: flex;
            flex-direction: column;
            align-items: stretch;
        }
        
        .slider-label {
            margin-bottom: 8px;
            color: #FFD700;
            font-weight: bold;
            font-size: 0.9rem;
            display: flex;
            justify-content: space-between;
        }
        
        .slider-label span {
            color: #aaa;
            font-weight: normal;
        }
        
        /* æ¨ªå‘æ»‘å—ï¼ˆåŠ¨ç”»æ§åˆ¶ï¼‰ */
        .slider {
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: #333;
            outline: none;
            opacity: 0.8;
            transition: opacity .2s;
            pointer-events: auto;
            -webkit-appearance: none;
        }
        
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #FFD700;
            cursor: pointer;
        }
        
        .slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #FFD700;
            cursor: pointer;
            border: none;
        }
        
        .slider:hover {
            opacity: 1;
        }
        
        /* éŸ³é¢‘æ§åˆ¶æ ·å¼ - æ ¸å¿ƒä¿®æ”¹ï¼šç¡®ä¿æ’­æ”¾æŒ‰é’®ã€éŸ³é‡æ»‘å—ã€æ–‡å­—ä¸­å¿ƒç‚¹ä¸¥æ ¼å‚ç›´å¯¹é½ */
        .audio-controls {
            position: fixed;
            top: 20px;          
            right: 20px;        
            z-index: 101;
            display: flex;
            flex-direction: column; 
            align-items: center;    /* å¼ºåˆ¶æ‰€æœ‰å­å…ƒç´ æ°´å¹³å±…ä¸­ */
            justify-content: flex-start;
            gap: 20px;              /* å¢åŠ é—´è·ï¼Œä¼˜åŒ–è§†è§‰ */
            pointer-events: auto;
            width: 60px;            /* å›ºå®šå®½åº¦ï¼Œç¡®ä¿å¯¹é½åŸºå‡† */
            /* è°ƒè¯•ç”¨ï¼šå¯ä»¥å¼€å¯æŸ¥çœ‹å¯¹é½çº¿
            border: 1px solid red;
            */
        }
        
        .audio-play-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: rgba(0, 0, 0, 0.7);
            border: 2px solid #FFD700;
            color: #FFD700;
            font-size: 18px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            backdrop-filter: blur(8px);
            /* å…³é”®ï¼šå›ºå®šä½ç½®ï¼Œç¡®ä¿ä¸­å¿ƒç‚¹åœ¨å®¹å™¨ä¸­å¿ƒ */
            margin: 0 auto;
            position: relative;
            left: 0;
            top: 0;
        }
        
        .audio-play-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 0 15px #FFD700;
        }
        
        /* éŸ³é‡æ»‘å—å®¹å™¨ - æ ¸å¿ƒä¿®æ”¹ï¼šä¸¥æ ¼å±…ä¸­å¯¹é½ */
        .volume-slider-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 10px;
            width: 100%;            /* ç»§æ‰¿çˆ¶å®¹å™¨å®½åº¦ï¼Œç¡®ä¿å¯¹é½ */
            height: 120px;
            position: relative;
            /* è°ƒè¯•ç”¨ï¼šå¯ä»¥å¼€å¯æŸ¥çœ‹å¯¹é½çº¿
            border: 1px solid green;
            */
        }
        
        /* éŸ³é‡æ»‘å— - æ ¸å¿ƒä¿®æ”¹ï¼šä¿®æ­£æ—‹è½¬å’Œä¸­å¿ƒç‚¹å¯¹é½ */
        .volume-slider {
            width: 120px;
            height: 8px;
            border-radius: 4px;
            background: #333;
            outline: none;
            opacity: 0.8;
            transition: opacity .2s;
            pointer-events: auto;
            -webkit-appearance: none;
            /* å…³é”®ä¿®æ”¹ï¼šæ—‹è½¬ä¸­å¿ƒæ”¹ä¸ºæ»‘å—ä¸­ç‚¹ */
            transform: rotate(-90deg);
            transform-origin: center center; /* æ»‘å—è‡ªèº«ä¸­å¿ƒç‚¹æ—‹è½¬ */
            position: absolute;
            left: 50%;               /* æ°´å¹³å±…ä¸­ */
            top: 50%;                /* å‚ç›´å±…ä¸­ */
            /* ç²¾ç¡®åç§»ï¼Œç¡®ä¿æ»‘å—ä¸­å¿ƒç‚¹ä¸å®¹å™¨/æ’­æ”¾æŒ‰é’®ä¸­å¿ƒç‚¹é‡åˆ */
            margin-left: -60px;      /* æ»‘å—å®½åº¦çš„ä¸€åŠ */
            margin-top: -4px;        /* æ»‘å—é«˜åº¦çš„ä¸€åŠ */
            /* è°ƒè¯•ç”¨ï¼šå¯ä»¥å¼€å¯æŸ¥çœ‹æ»‘å—å¯¹é½
            border: 1px solid blue;
            */
        }
        
        /* ç»Ÿä¸€æ»‘å—æ ·å¼ */
        .volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #FFD700;
            cursor: pointer;
            box-shadow: 0 0 8px rgba(255, 215, 0, 0.8);
        }
        
        .volume-slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #FFD700;
            cursor: pointer;
            border: none;
            box-shadow: 0 0 8px rgba(255, 215, 0, 0.8);
        }
        
        .volume-slider:hover {
            opacity: 1;
        }
        
        /* éŸ³é‡æ–‡å­— - æ ¸å¿ƒä¿®æ”¹ï¼šä¸¥æ ¼å±…ä¸­å¯¹é½ */
        .volume-label {
            color: #FFD700;
            font-size: 12px;
            font-weight: bold;
            text-align: center;
            position: absolute;
            bottom: -20px;
            left: 50%;              /* æ°´å¹³å±…ä¸­ */
            transform: translateX(-50%); /* ç²¾ç¡®åç§» */
            width: 100%;
            /* è°ƒè¯•ç”¨ï¼šå¯ä»¥å¼€å¯æŸ¥çœ‹æ–‡å­—å¯¹é½
            border: 1px solid yellow;
            */
        }
        
        .footer {
            position: fixed;
            bottom: 3px;
            left: 0;
            width: 100%;
            text-align: center;
            color: #aaa;
            font-size: 0.75rem;
            z-index: 100;
            pointer-events: none;
        }
        
        .info-text {
            position: fixed;
            top: 130px;         /* åŒæ­¥è°ƒæ•´æç¤ºæ–‡å­—ä½ç½®ï¼Œè·Ÿéšæ ‡é¢˜ä¸‹ç§» */
            left: 0;
            width: 100%;
            text-align: center;
            font-size: 11px;
            opacity: 0.6;
            pointer-events: none;
            z-index: 100;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        /* ç§»åŠ¨ç«¯ä¸‹æ‹‰æ§åˆ¶é¢æ¿ */
        .mobile-controls-toggle {
            display: none;
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: rgba(0, 0, 0, 0.7);
            color: #FFD700;
            text-align: center;
            padding: 12px;
            z-index: 101;
            cursor: pointer;
            pointer-events: auto;
            border-top: 2px solid rgba(255, 215, 0, 0.3);
            border-radius: 15px 15px 0 0;
            backdrop-filter: blur(8px);
        }
        
        .mobile-controls-toggle span {
            font-size: 0.9rem;
            font-weight: bold;
            display: block;
        }
        
        .mobile-controls-toggle .arrow {
            font-size: 1.2rem;
            margin-top: 4px;
            transition: transform 0.3s ease;
        }
        
        .mobile-controls-toggle .arrow.up {
            transform: rotate(180deg);
        }
        
        /* ç§»åŠ¨ç«¯é€‚é… - åŒæ­¥è°ƒæ•´éŸ³é¢‘æ§ä»¶å¯¹é½ */
        @media (max-width: 1024px) {
            .title-overlay {
                top: 40px;  /* ç§»åŠ¨ç«¯æ ‡é¢˜é€‚å½“ä¸‹ç§»ï¼ˆæ¯”PCç«¯å°‘ä¸€ç‚¹ï¼‰ */
            }
            
            .controls-container {
                position: fixed;
                bottom: 0;
                left: 0;
                width: 100%;
                flex-direction: column;
                align-items: center;
                gap: 0;
                padding: 0;
                transform: translateY(100%);
                transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
                background: rgba(0, 0, 0, 0.85);
                backdrop-filter: blur(10px);
                border-top: 2px solid rgba(255, 215, 0, 0.3);
                border-radius: 20px 20px 0 0;
                overflow: hidden;
                max-height: 80vh;
                overflow-y: auto;
                pointer-events: auto;
            }
            
            .controls-container.active {
                transform: translateY(0);
            }
            
            .style-panel, .speed-panel {
                width: 100%;
                max-width: 100%;
                padding: 20px;
                border-radius: 0;
                border: none;
                box-shadow: none;
                background: transparent;
            }
            
            .mobile-controls-toggle {
                display: block;
            }
            
            .style-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
            }
            
            .speed-controls {
                gap: 20px;
            }
            
            .slider-container {
                margin-bottom: 10px;
            }

            /* ç§»åŠ¨ç«¯éŸ³é¢‘æ§ä»¶ - ä¿æŒå‚ç›´å¯¹é½ */
            .audio-controls {
                width: 55px;  /* åŒæ­¥ç¼©å°å®¹å™¨å®½åº¦ */
                gap: 15px;
            }
            .audio-play-btn {
                width: 45px;
                height: 45px;
                font-size: 16px;
            }
            .volume-slider-container {
                width: 100%;
                height: 100px;
            }
            .volume-slider {
                width: 100px;
                margin-left: -50px;  /* å¯¹åº”æ»‘å—å®½åº¦çš„ä¸€åŠ */
                margin-top: -4px;    /* æ»‘å—é«˜åº¦çš„ä¸€åŠ */
            }
        }
        
        @media (max-width: 768px) {
            .main-title {
                font-size: 2.4rem;
            }
            
            .square-char {
                font-size: 2.8rem;
            }
            
            .style-btn {
                padding: 8px 5px;
                font-size: 0.85rem;
                height: 40px;
            }
            
            .controls-container {
                max-height: 70vh;
            }
            
            .info-text {
                top: 100px;  /* ç§»åŠ¨ç«¯æç¤ºæ–‡å­—åŒæ­¥ä¸‹ç§» */
            }
        }
        
        @media (max-width: 480px) {
            .title-overlay {
                top: 30px;  /* å°å±ç§»åŠ¨ç«¯æ ‡é¢˜è¿›ä¸€æ­¥å¾®è°ƒ */
            }
            
            .main-title {
                font-size: 2rem;
            }
            
            .square-char {
                font-size: 2.4rem;
            }
            
            .style-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 6px;
            }
            
            .style-btn {
                padding: 6px 4px;
                font-size: 0.8rem;
                height: 38px;
            }
            
            .controls-container {
                max-height: 65vh;
            }
            
            .style-panel, .speed-panel {
                padding: 15px;
            }
            
            /* å°å±ç§»åŠ¨ç«¯éŸ³é¢‘æ§ä»¶ - ä¿æŒå‚ç›´å¯¹é½ */
            .audio-controls {
                width: 50px;
                gap: 10px;
            }
            .audio-play-btn {
                width: 40px;
                height: 40px;
                font-size: 14px;
            }
            .volume-slider-container {
                width: 100%;
                height: 80px;
            }
            .volume-slider {
                width: 80px;
                margin-left: -40px;  /* å¯¹åº”æ»‘å—å®½åº¦çš„ä¸€åŠ */
                margin-top: -4px;    /* æ»‘å—é«˜åº¦çš„ä¸€åŠ */
            }
            
            .info-text {
                top: 90px;
            }
        }
        
        /* éšè—åŸå§‹åº•éƒ¨é¢æ¿å’ŒåŸç”ŸéŸ³é¢‘æ§ä»¶ */
        .controls-panel {
            display: none;
        }
        
        #christmasAudio {
            display: none;
        }
    </style>
    <!-- æ·»åŠ åœ£è¯è‰ºæœ¯å­—ä½“ -->
    <link href="https://fonts.googleapis.com/css2?family=Mountains+of+Christmas:wght@400;700&family=Ma+Shan+Zheng&display=swap" rel="stylesheet">
    <!-- Three.js åº“ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <!-- OrbitControls ç”¨äºé¼ æ ‡æ§åˆ¶ -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.min.js"></script>
</head>
<body>
    <canvas id="scene3d"></canvas>
    
    <div class="title-overlay">
        <div class="main-title" id="mainTitle">
            <span class="square-char" id="squareChar">â– </span>åä¸€ï½œåœ£è¯å¿«ä¹ï¼
        </div>
    </div>
    
    <div class="info-text" id="infoText">é¼ æ ‡æ‹–æ‹½æ—‹è½¬è§†è§’ | æ»šè½®ç¼©æ”¾</div>
    
    <!-- ç§»åŠ¨ç«¯ä¸‹æ‹‰åˆ‡æ¢æŒ‰é’® -->
    <div class="mobile-controls-toggle" id="mobileToggle">
        <span>æ§åˆ¶é¢æ¿</span>
        <div class="arrow" id="toggleArrow">â–¼</div>
    </div>
    
    <!-- æ–°çš„å·¦å³æ§ä»¶å¸ƒå±€ -->
    <div class="controls-container" id="controlsContainer">
        <!-- å·¦ä¾§é£æ ¼é€‰æ‹©é¢æ¿ -->
        <div class="style-panel">
            <h3>ğŸ„ é€‰æ‹©åœ£è¯æ ‘é£æ ¼</h3>
            <div class="style-grid">
                <button class="style-btn active" data-style="1">ç»å…¸ç»¿è‰²</button>
                <button class="style-btn" data-style="2">å†°é›ªè“</button>
                <button class="style-btn" data-style="3">æš—é»‘ç»¿</button>
                <button class="style-btn" data-style="4">å¤šå½©åœ£è¯</button>
                <button class="style-btn" data-style="5">é»‘ç™½æç®€</button>
                <button class="style-btn" data-style="6">ç²‰è‰²æµªæ¼«</button>
            </div>
        </div>
        
        <!-- å³ä¾§é€Ÿåº¦æ§åˆ¶é¢æ¿ -->
        <div class="speed-panel">
            <h3>âš™ï¸ åŠ¨ç”»é€Ÿåº¦æ§åˆ¶</h3>
            <div class="speed-controls">
                <div class="slider-container">
                    <div class="slider-label">
                        æ ‘æ—‹è½¬é€Ÿåº¦
                        <span id="rotationSpeedValue">0.006</span>
                    </div>
                    <input type="range" min="1" max="100" value="45" class="slider" id="rotationSpeedSlider">
                </div>
                
                <div class="slider-container">
                    <div class="slider-label">
                        é›ªèŠ±ä¸‹è½é€Ÿåº¦
                        <span id="snowSpeedValue">0.7</span>
                    </div>
                    <input type="range" min="1" max="100" value="35" class="slider" id="snowSpeedSlider">
                </div>
                
                <div class="slider-container">
                    <div class="slider-label">
                        æ˜Ÿæ˜Ÿé—ªçƒé€Ÿåº¦
                        <span id="starSpeedValue">0.6</span>
                    </div>
                    <input type="range" min="1" max="100" value="60" class="slider" id="starSpeedSlider">
                </div>
            </div>
        </div>
    </div>
    
    <!-- éšè—åŸå§‹åº•éƒ¨é¢æ¿ -->
    <div class="controls-panel">
        <div class="style-section">
            <h3>é€‰æ‹©åœ£è¯æ ‘é£æ ¼</h3>
            <div class="style-grid">
                <button class="style-btn active" data-style="1">ç»å…¸ç»¿è‰²</button>
                <button class="style-btn" data-style="2">å†°é›ªè“</button>
                <button class="style-btn" data-style="3">æš—é»‘ç»¿</button>
                <button class="style-btn" data-style="4">å¤šå½©åœ£è¯</button>
                <button class="style-btn" data-style="5">é»‘ç™½æç®€</button>
                <button class="style-btn" data-style="6">ç²‰è‰²æµªæ¼«</button>
            </div>
        </div>
        
        <div class="speed-controls">
            <div class="slider-container">
                <div class="slider-label">æ ‘æ—‹è½¬é€Ÿåº¦</div>
                <input type="range" min="1" max="100" value="45" class="slider" id="rotationSpeedSliderOld">
                <div class="value-display">é€Ÿåº¦: <span id="rotationSpeedValueOld">0.006</span></div>
            </div>
            
            <div class="slider-container">
                <div class="slider-label">é›ªèŠ±ä¸‹è½é€Ÿåº¦</div>
                <input type="range" min="1" max="100" value="35" class="slider" id="snowSpeedSliderOld">
                <div class="value-display">é€Ÿåº¦: <span id="snowSpeedValueOld">0.7</span></div>
            </div>
            
            <div class="slider-container">
                <div class="slider-label">æ˜Ÿæ˜Ÿé—ªçƒé€Ÿåº¦</div>
                <input type="range" min="1" max="100" value="60" class="slider" id="starSpeedSliderOld">
                <div class="value-display">é€Ÿåº¦: <span id="starSpeedValueOld">0.6</span></div>
            </div>
        </div>
    </div>
    
    <!-- éŸ³é¢‘æ§ä»¶ -->
    <audio id="christmasAudio" loop>
        <source src="file:///D:/æ¡Œé¢/åœ£è¯èŠ‚/Mariah%20Carey%20-%20All%20I%20Want%20For%20Christmas%20Is%20You.mp3" type="audio/mpeg">
        æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒéŸ³é¢‘æ’­æ”¾
    </audio>
    
    <!-- è‡ªå®šä¹‰éŸ³é¢‘æ§åˆ¶ï¼ˆä¸¥æ ¼å‚ç›´å¯¹é½ï¼‰ -->
    <div class="audio-controls">
        <button class="audio-play-btn" id="audioPlayBtn">â–¶ï¸</button>
        <div class="volume-slider-container">
            <div class="volume-label">éŸ³é‡</div>
            <input type="range" min="0" max="100" value="80" class="volume-slider" id="volumeSlider">
        </div>
    </div>
    
    <div class="footer">
        <p id="footerText">â– åä¸€ï½œåœ£è¯å¿«ä¹ï¼</p>
    </div>

    <script>
        // ========== éŸ³é¢‘æ§åˆ¶é€»è¾‘ - ç»Ÿä¸€PC/ç§»åŠ¨ç«¯ï¼ˆç§»é™¤è®¾å¤‡åˆ¤æ–­ï¼‰ ==========
        document.addEventListener('DOMContentLoaded', function() {
            const audio = document.getElementById('christmasAudio');
            const playBtn = document.getElementById('audioPlayBtn');
            const volumeSlider = document.getElementById('volumeSlider');
            
            // åˆå§‹åŒ–éŸ³é‡ï¼ˆç»Ÿä¸€é€»è¾‘ï¼šæ»‘å—å€¼/100ï¼‰
            audio.volume = volumeSlider.value / 100;
            
            // æ’­æ”¾/æš‚åœåˆ‡æ¢
            playBtn.addEventListener('click', function() {
                if (audio.paused) {
                    audio.play().then(() => {
                        playBtn.textContent = 'â¸ï¸';
                        console.log('åœ£è¯èƒŒæ™¯éŸ³ä¹å¼€å§‹æ’­æ”¾ ğŸµ');
                    }).catch(err => {
                        console.log('æ’­æ”¾å¤±è´¥:', err);
                    });
                } else {
                    audio.pause();
                    playBtn.textContent = 'â–¶ï¸';
                    console.log('åœ£è¯èƒŒæ™¯éŸ³ä¹å·²æš‚åœ â¸ï¸');
                }
            });
            
            // éŸ³é‡æ§åˆ¶é€»è¾‘ - ç»Ÿä¸€ï¼ˆå‘ä¸Šæ‹–åŠ¨/å‘å³æ‹–åŠ¨ = éŸ³é‡å¢å¤§ï¼‰
            volumeSlider.addEventListener('input', function() {
                const volumeValue = this.value / 100;
                audio.volume = volumeValue;
                console.log('å½“å‰éŸ³é‡:', volumeValue.toFixed(2));
            });
            
            // è§£å†³æµè§ˆå™¨è‡ªåŠ¨æ’­æ”¾ç­–ç•¥é™åˆ¶
            function initAudioPlay() {
                audio.play().then(() => {
                    playBtn.textContent = 'â¸ï¸';
                }).catch(err => {
                    console.log('è‡ªåŠ¨æ’­æ”¾è¢«é˜»æ­¢ï¼Œç‚¹å‡»æ’­æ”¾æŒ‰é’®å¼€å§‹æ’­æ”¾:', err);
                });
                document.body.removeEventListener('click', initAudioPlay);
                document.body.removeEventListener('touchstart', initAudioPlay);
            }
            
            // å°è¯•è‡ªåŠ¨æ’­æ”¾
            audio.play().catch(err => {
                document.body.addEventListener('click', initAudioPlay);
                document.body.addEventListener('touchstart', initAudioPlay);
            });
        });

        // åˆå§‹åŒ–Three.jsåœºæ™¯
        const scene = new THREE.Scene();
        const canvas = document.getElementById('scene3d');
        const renderer = new THREE.WebGLRenderer({ 
            canvas, 
            antialias: true,
            alpha: true,
            powerPreference: "high-performance"
        });
        
        // è®¾ç½®æ¸²æŸ“å™¨
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        renderer.shadowMap.enabled = true;
        renderer.shadowMap.type = THREE.PCFSoftShadowMap;
        
        // ç›¸æœº
        const camera = new THREE.PerspectiveCamera(
            60, 
            window.innerWidth / window.innerHeight, 
            0.1, 
            1000
        );
        camera.position.set(0, 0.5, 3);
        
        // è½¨é“æ§åˆ¶å™¨
        const controls = new THREE.OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        controls.dampingFactor = 0.05;
        controls.minDistance = 1.5;
        controls.maxDistance = 5;
        controls.maxPolarAngle = Math.PI / 2;
        
        // ç¯å…‰
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
        scene.add(ambientLight);
        
        const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
        directionalLight.position.set(5, 5, 5);
        directionalLight.castShadow = true;
        scene.add(directionalLight);
        
        // 6ç§é£æ ¼é…ç½®
        const styles = {
            "1": { // ç»å…¸ç»¿è‰²
                bg_col: "#0f0505", 
                tree_cols: ["#0B3D0B", "#144514", "#006400"],
                trunk_col: "#3e2723", 
                decor_cols: ["#FFD700", "#CCA43B", "#8B0000"],
                star_col: "#FFD700", 
                text_col: "#FFD700", 
                snow_col: "white",
                ribbon: true, 
                ribbon_col: "#D4AF37", 
                ribbon_width: 1.5
            },
            "2": { // å†°é›ªè“
                bg_col: "#F0F2F5", 
                tree_cols: ["#2F4F4F", "#5F9EA0", "#708090"],
                trunk_col: "#696969", 
                decor_cols: ["#B0C4DE", "#FFFAF0", "#E0FFFF"],
                star_col: "#B0C4DE", 
                text_col: "#708090", 
                snow_col: "#87CEFA",
                ribbon: true, 
                ribbon_col: "#B0C0C0", 
                ribbon_width: 1.5
            },
            "3": { // æš—é»‘ç»¿
                bg_col: "#1a1a1a", 
                tree_cols: ["#556B2F", "#6B8E23", "#808000"],
                trunk_col: "#5D4037", 
                decor_cols: ["#CD853F", "#FFCC00"],
                star_col: "#FFCC00", 
                text_col: "#DEB887", 
                snow_col: "white",
                ribbon: false, 
                ribbon_col: null, 
                ribbon_width: 0
            },
            "4": { // å¤šå½©åœ£è¯
                bg_col: "#101010", 
                tree_cols: ["#006400", "#228B22"],
                trunk_col: "#4E342E", 
                decor_cols: ["#FF0000", "#00FF00", "#0000FF", "#FFFF00"],
                star_col: "#FFD700", 
                text_col: "#FF6347", 
                snow_col: "white",
                ribbon: true, 
                ribbon_col: "#C0C0C0", 
                ribbon_width: 1.0
            },
            "5": { // é»‘ç™½æç®€
                bg_col: "#000000", 
                tree_cols: ["#111111", "#050505"],
                trunk_col: "#222222", 
                decor_cols: ["#FFFFFF", "#FFFFE0"],
                star_col: "#FFFFFF", 
                text_col: "#FFFFFF", 
                snow_col: "#4d4d4d",
                ribbon: true, 
                ribbon_col: "#FFFFFF", 
                ribbon_width: 0.8
            },
            "6": { // ç²‰è‰²æµªæ¼«
                bg_col: "#1F0F12",
                tree_cols: ["#D87093", "#FF69B4", "#FFB6C1"],
                trunk_col: "#4A3728",
                decor_cols: ["#FFFFFF", "#FFD700", "#FF1493"],
                star_col: "#FFD700",
                text_col: "#FFC0CB",
                snow_col: "#FFF0F5",
                ribbon: true,
                ribbon_col: "#F8F8FF",
                ribbon_width: 0.8,
                ribbon_burr: 0.04
            }
        };
        
        // å…¨å±€å˜é‡
        let currentStyle = "1";
        let treeGroup = new THREE.Group();
        let decorationsGroup = new THREE.Group();
        let ribbonGroup = new THREE.Group();
        let snowGroup = new THREE.Group();
        let star = null;
        let starLight = null;
        
        // é€Ÿåº¦æ§åˆ¶å˜é‡
        let rotationSpeed = 0.006;
        let snowSpeed = 0.7;
        let starSpeed = 0.6;
        
        let snowParticles = [];
        let frameId = 0;
        const n_frames = 90;
        
        // å·¥å…·å‡½æ•°
        function hexToRgb(hex) {
            if (typeof hex !== 'string') return { r: 1, g: 1, b: 1 };
            const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
            return result ? {
                r: parseInt(result[1], 16) / 255,
                g: parseInt(result[2], 16) / 255,
                b: parseInt(result[3], 16) / 255
            } : { r: 1, g: 1, b: 1 };
        }
        
        // ç”Ÿæˆéšæœºæ•°
        function random(min, max) {
            return Math.random() * (max - min) + min;
        }
        
        // ç”Ÿæˆåœ£è¯æ ‘æ•°æ®
        function generateTreeData(cfg) {
            const data = {
                trunk: [],
                tree: [],
                decor: [],
                ribbon: []
            };
            
            // ç”Ÿæˆæ ‘å¹²æ•°æ®
            for (let i = 0; i < 1000; i++) {
                const h_trunk = random(-0.7, -0.45);
                const r_trunk = 0.12;
                const theta_trunk = random(0, Math.PI * 2);
                
                data.trunk.push({
                    x: r_trunk * Math.cos(theta_trunk),
                    y: h_trunk,
                    z: r_trunk * Math.sin(theta_trunk),
                    col: cfg.trunk_col,
                    size: 1.2,
                    type: "trunk",
                    alpha: 1
                });
            }
            
            // ç”Ÿæˆæ ‘å¶æ•°æ®
            for (let i = 0; i < 8000; i++) {
                const h = random(0, 1);
                const base_r = (1 - h);
                const layer_cycle = (h * 7) % 1;
                const r = base_r * 0.65 * (0.4 + 0.6 * Math.pow((1 - layer_cycle), 0.7));
                const theta = random(0, Math.PI * 2);
                
                data.tree.push({
                    x: r * Math.cos(theta),
                    y: h - 0.5,
                    z: r * Math.sin(theta),
                    col: cfg.tree_cols[Math.floor(random(0, cfg.tree_cols.length))],
                    size: random(0.6, 1.8),
                    type: "tree",
                    alpha: 0.95
                });
            }
            
            // ç”Ÿæˆè£…é¥°ç‰©æ•°æ®
            for (let i = 0; i < 600; i++) {
                const h_dec = random(0, 0.95);
                const base_r_dec = (1 - h_dec);
                const layer_cycle_dec = (h_dec * 7) % 1;
                const r_dec = base_r_dec * 0.68 * (0.4 + 0.6 * Math.pow((1 - layer_cycle_dec), 0.7));
                const theta_dec = random(0, Math.PI * 2);
                
                data.decor.push({
                    x: r_dec * Math.cos(theta_dec),
                    y: h_dec - 0.5,
                    z: r_dec * Math.sin(theta_dec),
                    col: cfg.decor_cols[Math.floor(random(0, cfg.decor_cols.length))],
                    size: random(2, 4),
                    type: "decor",
                    alpha: 1
                });
            }
            
            // ç”Ÿæˆä¸å¸¦æ•°æ®
            if (cfg.ribbon) {
                for (let i = 0; i <= 6000; i++) {
                    const h_rib = i / 6000 * 0.95;
                    const base_r_rib = (1 - h_rib) * 0.65 * 1.05;
                    const theta_rib = 10 * Math.PI * h_rib;
                    
                    data.ribbon.push({
                        x: base_r_rib * Math.cos(theta_rib),
                        y: h_rib - 0.5,
                        z: base_r_rib * Math.sin(theta_rib),
                        col: cfg.ribbon_col,
                        size: cfg.ribbon_width,
                        type: "ribbon",
                        alpha: 1
                    });
                }
            }
            
            return data;
        }
        
        // ç”Ÿæˆé›ªèŠ±æ•°æ®
        function generateSnow(cfg) {
            const snowData = [];
            for (let i = 0; i < 250; i++) {
                const speed = random(0.00025, 0.00075) * snowSpeed * 10;
                snowData.push({
                    x: random(-1, 1),
                    y: random(-0.8, 1.2),
                    z: random(-1, 1),
                    col: cfg.snow_col,
                    size: random(0.5, 2),
                    type: "snow",
                    alpha: random(0.5, 0.9),
                    speed: speed
                });
            }
            return snowData;
        }
        
        // ç”Ÿæˆæ ‡å‡†äº”è§’æ˜Ÿå¤šè¾¹å½¢ - ä¿®å¤ç‰ˆ
        function getStarPolygon(x_center, y_center, radius) {
            const starShape = new THREE.Shape();
            
            // æ ‡å‡†äº”è§’æ˜Ÿçš„ç”Ÿæˆå‚æ•°
            const outerRadius = radius;      // å¤–æ¥åœ†åŠå¾„
            const innerRadius = radius * 0.4; // å†…æ¥åœ†åŠå¾„
            const numPoints = 5;             // äº”ä¸ªé¡¶ç‚¹
            
            // èµ·å§‹è§’åº¦è°ƒæ•´ï¼Œä½¿ä¸€ä¸ªè§’æŒ‡å‘æ­£ä¸Šæ–¹
            const startAngle = -Math.PI / 2; // ä»12ç‚¹æ–¹å‘å¼€å§‹
            
            for (let i = 0; i <= numPoints * 2; i++) {
                let angle, r;
                
                if (i % 2 === 0) {
                    // å¤–é¡¶ç‚¹
                    angle = startAngle + (i * Math.PI) / numPoints;
                    r = outerRadius;
                } else {
                    // å†…é¡¶ç‚¹
                    angle = startAngle + (i * Math.PI) / numPoints;
                    r = innerRadius;
                }
                
                const x = x_center + r * Math.cos(angle);
                const y = y_center + r * Math.sin(angle);
                
                if (i === 0) {
                    starShape.moveTo(x, y);
                } else {
                    starShape.lineTo(x, y);
                }
            }
            
            return starShape;
        }
        
        // åˆ›å»ºåœ£è¯æ ‘åœºæ™¯
        function createTreeScene(cfg) {
            // æ¸…é™¤ç°æœ‰åœºæ™¯
            scene.remove(treeGroup);
            scene.remove(decorationsGroup);
            scene.remove(ribbonGroup);
            scene.remove(snowGroup);
            if (star) scene.remove(star);
            if (starLight) scene.remove(starLight);
            
            // åˆ›å»ºæ–°ç»„
            treeGroup = new THREE.Group();
            decorationsGroup = new THREE.Group();
            ribbonGroup = new THREE.Group();
            snowGroup = new THREE.Group();
            
            // ç”Ÿæˆæ•°æ®
            const treeData = generateTreeData(cfg);
            const snowData = generateSnow(cfg);
            
            // åˆ›å»ºæ ‘å¹²
            const trunkGeometry = new THREE.BufferGeometry();
            const trunkPositions = [];
            const trunkColors = [];
            const trunkSizes = [];
            
            treeData.trunk.forEach(trunk => {
                trunkPositions.push(trunk.x, trunk.y, trunk.z);
                const color = hexToRgb(trunk.col);
                trunkColors.push(color.r, color.g, color.b);
                trunkSizes.push(trunk.size * 0.015);
            });
            
            trunkGeometry.setAttribute('position', new THREE.Float32BufferAttribute(trunkPositions, 3));
            trunkGeometry.setAttribute('color', new THREE.Float32BufferAttribute(trunkColors, 3));
            trunkGeometry.setAttribute('size', new THREE.Float32BufferAttribute(trunkSizes, 1));
            
            const trunkMaterial = new THREE.PointsMaterial({
                size: 0.05,
                vertexColors: true,
                sizeAttenuation: true
            });
            
            const trunk = new THREE.Points(trunkGeometry, trunkMaterial);
            treeGroup.add(trunk);
            
            // åˆ›å»ºæ ‘å¶
            const treeGeometry = new THREE.BufferGeometry();
            const treePositions = [];
            const treeColors = [];
            const treeSizes = [];
            
            treeData.tree.forEach(leaf => {
                treePositions.push(leaf.x, leaf.y, leaf.z);
                const color = hexToRgb(leaf.col);
                treeColors.push(color.r, color.g, color.b);
                treeSizes.push(leaf.size * 0.01);
            });
            
            treeGeometry.setAttribute('position', new THREE.Float32BufferAttribute(treePositions, 3));
            treeGeometry.setAttribute('color', new THREE.Float32BufferAttribute(treeColors, 3));
            treeGeometry.setAttribute('size', new THREE.Float32BufferAttribute(treeSizes, 1));
            
            const treeMaterial = new THREE.PointsMaterial({
                size: 0.02,
                vertexColors: true,
                sizeAttenuation: true
            });
            
            const tree = new THREE.Points(treeGeometry, treeMaterial);
            treeGroup.add(tree);
            
            // åˆ›å»ºè£…é¥°ç‰©
            const decorGeometry = new THREE.BufferGeometry();
            const decorPositions = [];
            const decorColors = [];
            const decorSizes = [];
            
            treeData.decor.forEach(decor => {
                decorPositions.push(decor.x, decor.y, decor.z);
                const color = hexToRgb(decor.col);
                decorColors.push(color.r, color.g, color.b);
                decorSizes.push(decor.size * 0.015);
            });
            
            decorGeometry.setAttribute('position', new THREE.Float32BufferAttribute(decorPositions, 3));
            decorGeometry.setAttribute('color', new THREE.Float32BufferAttribute(decorColors, 3));
            decorGeometry.setAttribute('size', new THREE.Float32BufferAttribute(decorSizes, 1));
            
            const decorMaterial = new THREE.PointsMaterial({
                size: 0.05,
                vertexColors: true,
                sizeAttenuation: true
            });
            
            const decorations = new THREE.Points(decorGeometry, decorMaterial);
            decorationsGroup.add(decorations);
            
            // åˆ›å»ºä¸å¸¦
            if (cfg.ribbon && treeData.ribbon.length > 0) {
                const ribbonGeometry = new THREE.BufferGeometry();
                const ribbonPositions = [];
                const ribbonColors = [];
                
                treeData.ribbon.forEach(point => {
                    ribbonPositions.push(point.x, point.y, point.z);
                    const color = hexToRgb(point.col);
                    ribbonColors.push(color.r, color.g, color.b);
                });
                
                ribbonGeometry.setAttribute('position', new THREE.Float32BufferAttribute(ribbonPositions, 3));
                ribbonGeometry.setAttribute('color', new THREE.Float32BufferAttribute(ribbonColors, 3));
                
                const ribbonMaterial = new THREE.LineBasicMaterial({
                    color: cfg.ribbon_col,
                    linewidth: cfg.ribbon_width
                });
                
                const ribbon = new THREE.Line(ribbonGeometry, ribbonMaterial);
                ribbonGroup.add(ribbon);
            }
            
            // åˆ›å»ºæ˜Ÿæ˜Ÿ - ä½¿ç”¨ä¼˜åŒ–çš„æ ‡å‡†äº”è§’æ˜Ÿ
            const starShape = getStarPolygon(0, 0, 0.04); // ç¨å¾®å¢å¤§æ˜Ÿæ˜Ÿå°ºå¯¸
            const starGeometry = new THREE.ShapeGeometry(starShape);
            const starMaterial = new THREE.MeshBasicMaterial({ 
                color: cfg.star_col,
                side: THREE.DoubleSide
            });
            star = new THREE.Mesh(starGeometry, starMaterial);
            
            // å…³é”®ä¿®å¤ï¼šå°†æ˜Ÿæ˜Ÿç²¾ç¡®é•¶åµŒåœ¨åœ£è¯æ ‘é¡¶å°–
            // åœ£è¯æ ‘çš„é«˜åº¦èŒƒå›´æ˜¯-0.5åˆ°0.5ï¼Œæ ‘é¡¶æ˜¯y=0.5
            // æ˜Ÿæ˜Ÿçš„å½¢çŠ¶æ˜¯ä»ä¸­å¿ƒå‘å¤–æ‰©å±•ï¼Œæ˜Ÿæ˜Ÿæœ€ä¸‹æ–¹çš„è§’åœ¨y = -starRadius
            // æˆ‘ä»¬éœ€è¦å°†æ˜Ÿæ˜Ÿçš„æœ€ä¸‹æ–¹è§’æ”¾åœ¨æ ‘é¡¶y=0.5çš„ä½ç½®
            // æ˜Ÿæ˜Ÿä¸­å¿ƒy = æ ‘é¡¶y + starRadius
            const starRadius = 0.04;
            const treeTopY = 0.5; // åœ£è¯æ ‘é¡¶éƒ¨yåæ ‡
            
            // è®¡ç®—æ˜Ÿæ˜Ÿä¸­å¿ƒä½ç½®ï¼šæ ‘é¡¶y + æ˜Ÿæ˜ŸåŠå¾„
            // è¿™æ ·æ˜Ÿæ˜Ÿçš„æœ€ä¸‹æ–¹è§’å°±åœ¨y=0.5ï¼Œåˆšå¥½æ¥è§¦æ ‘é¡¶
            const starCenterY = treeTopY + starRadius;
            
            // ä¸ºäº†è®©æ˜Ÿæ˜Ÿçœ‹èµ·æ¥æ˜¯"é•¶"åœ¨æ ‘é¡¶ï¼Œè€Œä¸æ˜¯æ”¾åœ¨ä¸Šé¢
            // æˆ‘ä»¬å¯ä»¥ç¨å¾®å°†æ˜Ÿæ˜Ÿå‘ä¸‹ç§»åŠ¨ä¸€ç‚¹ï¼Œè®©æ˜Ÿæ˜Ÿçš„ä¸€éƒ¨åˆ†åµŒå…¥æ ‘ä¸­
            const starEmbeddedY = starCenterY - 0.02; // å‘ä¸‹ç§»åŠ¨0.02ï¼Œè®©æ˜Ÿæ˜ŸåµŒå…¥æ ‘é¡¶
            
            star.position.set(0, starEmbeddedY, 0.01); // zè½´ç¨å¾®å‘å‰ï¼Œé¿å…è¢«æ ‘å¶é®æŒ¡
            
            // åˆ›å»ºå®¹å™¨ç»„æ¥å›ºå®šæ˜Ÿæ˜Ÿ
            const starContainer = new THREE.Group();
            starContainer.add(star);
            treeGroup.add(starContainer);
            
            // æ·»åŠ æ˜Ÿæ˜Ÿè¾‰å…‰
            starLight = new THREE.PointLight(cfg.star_col, 1.5, 1.5);
            starLight.position.copy(star.position);
            starContainer.add(starLight);
            
            // åˆ›å»ºé›ªèŠ±
            const snowGeometry = new THREE.BufferGeometry();
            const snowPositions = [];
            const snowColors = [];
            const snowSizes = [];
            
            snowParticles = [];
            snowData.forEach(flake => {
                snowPositions.push(flake.x, flake.y, flake.z);
                const color = hexToRgb(flake.col);
                snowColors.push(color.r, color.g, color.b);
                snowSizes.push(flake.size * 0.01);
                snowParticles.push(flake);
            });
            
            snowGeometry.setAttribute('position', new THREE.Float32BufferAttribute(snowPositions, 3));
            snowGeometry.setAttribute('color', new THREE.Float32BufferAttribute(snowColors, 3));
            snowGeometry.setAttribute('size', new THREE.Float32BufferAttribute(snowSizes, 1));
            
            const snowMaterial = new THREE.PointsMaterial({
                size: 0.02,
                vertexColors: true,
                transparent: true,
                opacity: 0.8,
                sizeAttenuation: true
            });
            
            const snow = new THREE.Points(snowGeometry, snowMaterial);
            snowGroup.add(snow);
            
            // æ·»åŠ åˆ°åœºæ™¯
            scene.add(treeGroup);
            scene.add(decorationsGroup);
            scene.add(ribbonGroup);
            scene.add(snowGroup);
            
            // æ›´æ–°èƒŒæ™¯è‰²å’Œæ–‡å­—é¢œè‰²
            document.body.style.backgroundColor = cfg.bg_col;
            const textColor = cfg.text_col;
            
            // æ›´æ–°æ ‡é¢˜é¢œè‰²
            const titleElement = document.getElementById('mainTitle');
            const squareChar = document.getElementById('squareChar');
            const infoText = document.getElementById('infoText');
            const footerText = document.getElementById('footerText');
            
            if (titleElement) titleElement.style.color = textColor;
            if (squareChar) squareChar.style.color = textColor;
            if (infoText) infoText.style.color = textColor;
            if (footerText) footerText.style.color = textColor;
            
            // æ›´æ–°æŒ‰é’®é¢œè‰²
            document.querySelectorAll('.style-btn').forEach(btn => {
                if (btn.classList.contains('active')) {
                    btn.style.boxShadow = `0 0 12px ${cfg.text_col}`;
                } else {
                    btn.style.boxShadow = 'none';
                }
            });
        }
        
        // åˆå§‹åŒ–åœºæ™¯
        createTreeScene(styles[currentStyle]);
        
        // åŠ¨ç”»å¾ªç¯
        const clock = new THREE.Clock();
        
        function animate() {
            requestAnimationFrame(animate);
            
            const delta = clock.getDelta();
            const elapsed = clock.getElapsedTime();
            
            // æ›´æ–°å¸§ID
            frameId = (frameId + 1) % n_frames;
            
            // æ—‹è½¬æ ‘
            treeGroup.rotation.y += rotationSpeed;
            decorationsGroup.rotation.y += rotationSpeed;
            ribbonGroup.rotation.y += rotationSpeed;
            
            // é—ªçƒæ˜Ÿæ˜Ÿ - ç°åœ¨æ˜Ÿæ˜Ÿå›ºå®šåœ¨æ ‘é¡¶ï¼Œåªæ—‹è½¬å’Œç¼©æ”¾
            if (star) {
                star.rotation.z += delta * starSpeed * 0.3;
                const scale = 1 + Math.sin(elapsed * starSpeed * 0.8) * 0.08; // å‡å°ç¼©æ”¾å¹…åº¦
                star.scale.set(scale, scale, scale);
            }
            
            // é£˜è½é›ªèŠ±
            if (snowGroup.children.length > 0) {
                const snowMesh = snowGroup.children[0];
                const positions = snowMesh.geometry.attributes.position.array;
                
                for (let i = 0; i < snowParticles.length; i++) {
                    const idx = i * 3;
                    snowParticles[i].y -= snowParticles[i].speed;
                    if (snowParticles[i].y < -0.8) {
                        snowParticles[i].y = 1.2;
                    }
                    positions[idx + 1] = snowParticles[i].y;
                }
                snowMesh.geometry.attributes.position.needsUpdate = true;
            }
            
            // æ›´æ–°æ§åˆ¶å™¨
            controls.update();
            
            // æ¸²æŸ“
            renderer.render(scene, camera);
        }
        
        animate();
        
        // çª—å£å¤§å°è°ƒæ•´
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
        
        // é£æ ¼åˆ‡æ¢
        document.querySelectorAll('.style-btn').forEach(button => {
            button.addEventListener('click', function() {
                // æ›´æ–°æ´»åŠ¨æŒ‰é’®
                document.querySelectorAll('.style-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                this.classList.add('active');
                
                // åˆ‡æ¢é£æ ¼
                currentStyle = this.dataset.style;
                createTreeScene(styles[currentStyle]);
            });
        });
        
        // é€Ÿåº¦æ§åˆ¶æ»‘å—
        const rotationSpeedSlider = document.getElementById('rotationSpeedSlider');
        const rotationSpeedValue = document.getElementById('rotationSpeedValue');
        const snowSpeedSlider = document.getElementById('snowSpeedSlider');
        const snowSpeedValue = document.getElementById('snowSpeedValue');
        const starSpeedSlider = document.getElementById('starSpeedSlider');
        const starSpeedValue = document.getElementById('starSpeedValue');
        
        // æ›´æ–°æ ‘æ—‹è½¬é€Ÿåº¦
        rotationSpeedSlider.addEventListener('input', function() {
            rotationSpeed = this.value / 10000 + 0.001;
            rotationSpeedValue.textContent = rotationSpeed.toFixed(4);
        });
        
        // æ›´æ–°é›ªèŠ±ä¸‹è½é€Ÿåº¦
        snowSpeedSlider.addEventListener('input', function() {
            snowSpeed = this.value / 50;
            snowSpeedValue.textContent = snowSpeed.toFixed(3);
            
            // é‡æ–°ç”Ÿæˆé›ªèŠ±æ•°æ®ä»¥åº”ç”¨æ–°é€Ÿåº¦
            createTreeScene(styles[currentStyle]);
        });
        
        // æ›´æ–°æ˜Ÿæ˜Ÿé—ªçƒé€Ÿåº¦
        starSpeedSlider.addEventListener('input', function() {
            starSpeed = this.value / 50;
            starSpeedValue.textContent = starSpeed.toFixed(2);
        });
        
        // åˆå§‹åŒ–æ»‘å—å€¼æ˜¾ç¤º
        rotationSpeedValue.textContent = rotationSpeed.toFixed(4);
        snowSpeedValue.textContent = snowSpeed.toFixed(3);
        starSpeedValue.textContent = starSpeed.toFixed(2);
        
        // ç§»åŠ¨ç«¯æ§åˆ¶é¢æ¿ä¸‹æ‹‰åŠŸèƒ½
        const mobileToggle = document.getElementById('mobileToggle');
        const controlsContainer = document.getElementById('controlsContainer');
        const toggleArrow = document.getElementById('toggleArrow');
        
        let isControlsVisible = false;
        let startY = 0;
        let isDragging = false;
        
        // ç‚¹å‡»åˆ‡æ¢æ§åˆ¶é¢æ¿
        mobileToggle.addEventListener('click', function() {
            isControlsVisible = !isControlsVisible;
            controlsContainer.classList.toggle('active', isControlsVisible);
            toggleArrow.classList.toggle('up', isControlsVisible);
        });
        
        // è§¦æ‘¸æ»‘åŠ¨æ§åˆ¶
        mobileToggle.addEventListener('touchstart', function(e) {
            startY = e.touches[0].clientY;
            isDragging = true;
        });
        
        mobileToggle.addEventListener('touchmove', function(e) {
            if (!isDragging) return;
            
            const currentY = e.touches[0].clientY;
            const deltaY = startY - currentY;
            
            // å‘ä¸‹æ»‘åŠ¨è¶…è¿‡30pxæ—¶å±•å¼€é¢æ¿
            if (deltaY < -30 && !isControlsVisible) {
                isControlsVisible = true;
                controlsContainer.classList.add('active');
                toggleArrow.classList.add('up');
                isDragging = false;
            }
            // å‘ä¸Šæ»‘åŠ¨è¶…è¿‡30pxæ—¶æ”¶èµ·é¢æ¿
            else if (deltaY > 30 && isControlsVisible) {
                isControlsVisible = false;
                controlsContainer.classList.remove('active');
                toggleArrow.classList.remove('up');
                isDragging = false;
            }
        });
        
        mobileToggle.addEventListener('touchend', function() {
            isDragging = false;
        });
        
        // ç‚¹å‡»æ§åˆ¶é¢æ¿å¤–éƒ¨åŒºåŸŸæ”¶èµ·é¢æ¿
        document.addEventListener('click', function(e) {
            if (isControlsVisible && 
                !controlsContainer.contains(e.target) && 
                !mobileToggle.contains(e.target) &&
                window.innerWidth <= 1024) {
                isControlsVisible = false;
                controlsContainer.classList.remove('active');
                toggleArrow.classList.remove('up');
            }
        });
        
        // é˜»æ­¢æ§åˆ¶é¢æ¿å†…éƒ¨ç‚¹å‡»äº‹ä»¶å†’æ³¡
        controlsContainer.addEventListener('click', function(e) {
            e.stopPropagation();
        });
    </script>
</body>
</html>
